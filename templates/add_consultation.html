{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add Consultation - MediCare</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .consultation-form {
        max-width: 800px;
        margin: 0 auto;
      }
      .patient-info-card {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-left: 4px solid #0cb76b;
      }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <div class="row">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Add Consultation Record</h2>
            <a
              href="{% url 'doctor_dashboard' %}"
              class="btn btn-outline-secondary"
            >
              ‚Üê Back to Dashboard
            </a>
          </div>

          <!-- Patient Info -->
          <div class="card patient-info-card mb-4">
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-person-badge me-2"></i>Patient Information
              </h5>
              <div class="row">
                <div class="col-md-6">
                  <p><strong>Name:</strong> {{ patient.full_name }}</p>
                  <p><strong>Age:</strong> {{ patient.age }}</p>
                  <p><strong>Gender:</strong> {{ patient.gender }}</p>
                </div>
                <div class="col-md-6">
                  <p>
                    <strong>Condition:</strong> {{ patient.disease|default:"Not
                    specified" }}
                  </p>
                  <p>
                    <strong>Assigned Doctor:</strong> {{
                    patient.doctor_assigned|default:"Not assigned" }}
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Consultation Form -->
          <div class="card consultation-form">
            <div class="card-header bg-primary text-white">
              <h5 class="mb-0">
                <i class="bi bi-file-medical me-2"></i>Consultation Details
              </h5>
            </div>
            <div class="card-body">
              <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <div class="row mb-3">
                  <div class="col-12">
                    <label for="symptoms" class="form-label"
                      ><strong>Symptoms</strong></label
                    >
                    <textarea
                      class="form-control"
                      id="symptoms"
                      name="symptoms"
                      rows="3"
                      placeholder="Describe patient symptoms..."
                      required
                    ></textarea>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-12">
                    <label for="diagnosis" class="form-label"
                      ><strong>Diagnosis</strong></label
                    >
                    <textarea
                      class="form-control"
                      id="diagnosis"
                      name="diagnosis"
                      rows="3"
                      placeholder="Medical diagnosis..."
                      required
                    ></textarea>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-12">
                    <label for="tests" class="form-label"
                      ><strong>Tests Conducted</strong></label
                    >
                    <textarea
                      class="form-control"
                      id="tests"
                      name="tests"
                      rows="2"
                      placeholder="List any tests conducted..."
                    ></textarea>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-12">
                    <label for="prescription" class="form-label"
                      ><strong>Prescription</strong></label
                    >
                    <textarea
                      class="form-control"
                      id="prescription"
                      name="prescription"
                      rows="4"
                      placeholder="Medications and dosage instructions..."
                      required
                    ></textarea>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-12">
                    <label for="notes" class="form-label"
                      ><strong>Additional Notes</strong></label
                    >
                    <textarea
                      class="form-control"
                      id="notes"
                      name="notes"
                      rows="2"
                      placeholder="Any additional observations..."
                    ></textarea>
                  </div>
                </div>

                <div class="row mb-4">
                  <div class="col-12">
                    <label for="prescription_file" class="form-label"
                      ><strong>Upload Prescription (Optional)</strong></label
                    >
                    <input
                      type="file"
                      class="form-control"
                      id="prescription_file"
                      name="prescription_file"
                      accept=".jpg,.jpeg,.png,.pdf"
                    />
                    <div class="form-text">
                      Upload prescription image or PDF file
                    </div>
                  </div>
                </div>

                <div class="alert alert-info">
                  <i class="bi bi-info-circle me-2"></i>
                  <strong>Blockchain Notice:</strong> This consultation will be
                  added to the patient's permanent medical history chain and a
                  new QR code will be generated.
                </div>

                <div class="d-grid gap-2">
                  <button type="submit" class="btn btn-success btn-lg">
                    <i class="bi bi-save me-2"></i>Save Consultation & Update
                    Blockchain
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
